{"version":3,"sources":["product_list.js"],"names":[],"mappings":"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","file":"product_list-s.js","sourcesContent":["/**\r\n * Created by web-01 on 2017/10/31.\r\n */\r\n$(function(){\r\n    var show = $(\"#showinfo\");\r\n\r\n    //加载商品列表\r\n    function getlistbypno(pno){\r\n        $.ajax({\r\n            url:\"data/getproducts.php\",\r\n            type:\"get\",\r\n            data:{\r\n                pno:pno,\r\n                pageSize:8\r\n            },\r\n            success:function(data){\r\n                var html=\"\";\r\n                var pno = parseInt(data.pno);\r\n                if(data.data.length!=0){\r\n                    for(var x in data.data){\r\n                        var ds = data.data[x];\r\n                        html+=`<tr>\r\n                <td>${ds.fid}</td>\r\n                <td><img width=\"30\" src=\"../${ds.lg}\" alt=\"\"/></td>\r\n                <td>${ds.title}</td>\r\n                <td>${ds.price}</td>\r\n                <td>${ds.reviews}</td>\r\n                <td>\r\n                  <button type=\"button\" data-fid=\"${ds.fid}\" class=\"btn btn-primary btn-xs btn-xq\">详情</button>\r\n                  <button type=\"button\" data-fid=\"${ds.fid}\" class=\"btn btn-info btn-xs btn-xg\">修改</button>\r\n                  <button type=\"button\" data-fid=\"${ds.fid}\" class=\"btn btn-danger btn-xs btn-sc\">删除</button>\r\n                </td>\r\n              </tr>`;\r\n                    }\r\n                }else{\r\n                    html+=\"<tr><td colspan='6'>找不到商品...</td></tr>\";\r\n                }\r\n\r\n\r\n                $(\"#tblist\").off().html(html).on(\"click\",'button',function(){\r\n\r\n                    var fid = $(this).data(\"fid\");\r\n                    if($(this).hasClass('btn-xq')){\r\n\r\n                        $.ajax({\r\n                            url:\"data/getproductbyid.php\",\r\n                            type:\"get\",\r\n                            data:{fid},\r\n                            success:function(data){\r\n                                var html = `<p>商品名称:${data.title}</p>\r\n                                    <p>商品价格:${data.price}</p>\r\n                                    <p>销量:${data.reviews}</p>\r\n                                    <p>详细描述:${data.detail2}</p>`;\r\n                                show.find('.modal-title').html(\"商品详情\");\r\n                                show.modal(\"show\").find('.modal-body').html(html);\r\n                            }\r\n                        });\r\n\r\n                    }else if($(this).hasClass('btn-xg')){\r\n                        var amsg=$(\"#alertmsg\");\r\n\r\n                        $.ajax({\r\n                            url:\"data/getproductbyid.php\",\r\n                            type:\"get\",\r\n                            data:{fid},\r\n                            success:function(data){\r\n                                var html =` <div class=\"form-group\">\r\n                <label for=\"title\">标题:</label>\r\n                <input type=\"text\" class=\"form-control\"  required name=\"title\" value=\"${data.title}\"/>\r\n               </div>\r\n\r\n               <div class=\"form-group\">\r\n                <label for=\"price\">价格:</label>\r\n                <input type=\"text\" class=\"form-control\" required name=\"price\" value=\"${data.price}\"/>\r\n               </div>`;\r\n\r\n                                amsg.find(\".modal-title\").html(\"修改\");\r\n                                amsg.modal(\"show\").find('.modal-body').html(html);\r\n                                $(\"#xgform\").on(\"submit\",function(e){\r\n                                    e.preventDefault();\r\n                                    var title = amsg.find(\"[name='title']\").val();\r\n                                    var price = amsg.find(\"[name='price']\").val();\r\n\r\n                                    if(!title || title==\" \"){\r\n                                        alert(\"商品名称必须填写\");\r\n                                        return;\r\n                                    }\r\n                                    if(!price || price==\" \" || isNaN(parseFloat(price))){\r\n                                        alert(\"价格填写不正确\");\r\n                                        return;\r\n                                    }\r\n                                    price = parseFloat(price).toFixed(2);\r\n\r\n                                    $.ajax({\r\n                                        url:\"data/upproduct.php\",\r\n                                        type:\"get\",\r\n                                        data:{fid,title,price},\r\n                                        success:function(data){\r\n                                            if(data.code==-1){\r\n                                                alert(\"修改失败\");\r\n                                            }\r\n                                            amsg.modal(\"hide\");\r\n                                            getlistbypno(pno);\r\n                                        }\r\n                                    });\r\n\r\n\r\n\r\n\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                    }else if($(this).hasClass(\"btn-sc\")){\r\n                        if(confirm(\"确定删除这个商品吗?\")){\r\n\r\n                            $.ajax({\r\n                                url:\"data/delpro.php\",\r\n                                type:\"post\",\r\n                                data:{fid},\r\n                                success:function(data){\r\n\r\n                                    if(data.code==-2){\r\n                                        show.find('.modal-title').html(\"提示信息\");\r\n                                        show.modal(\"show\").find('.modal-body').html('普通管理员无权操作');\r\n                                    }else if(data.code<=0){\r\n                                        show.find('.modal-title').html(\"提示信息\");\r\n                                        show.modal(\"show\").find('.modal-body').html('删除失败');\r\n                                    }else if(data.code==1){\r\n                                        //alert(\"删除成功\");\r\n                                        //console.log(1);\r\n                                        show.find('.modal-title').html(\"提示信息\");\r\n                                        show.modal(\"show\").find('.modal-body').html('删除成功');\r\n                                        getlistbypno(pno);\r\n                                    }\r\n                                }\r\n                            })\r\n\r\n                        }\r\n\r\n                   }\r\n                });\r\n\r\n\r\n                //加载分页条\r\n                var phtml=\"\";\r\n                var pages=$(\"#pagination\");\r\n                //var pno = parseInt(data.pno);\r\n                var prev = pno-1;\r\n                var next = pno+1;\r\n                var maxPage = parseInt(data.maxPage);\r\n\r\n                if(prev<=0)\r\n                    phtml+=`<li class=\"disabled\">\r\n                        <a href=\"#\" aria-label=\"Previous\">\r\n                            <span aria-hidden=\"true\">&laquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n                else\r\n                    phtml+=`<li>\r\n                        <a href=\"${pno-1}\" aria-label=\"Previous\">\r\n                            <span aria-hidden=\"true\">&laquo;</span>\r\n                        </a>\r\n                        </li>`;\r\n\r\n                if(pno-1>0)\r\n                    phtml+=` <li><a href=\"${pno-1}\">${pno-1}</a></li>`;\r\n\r\n                phtml+=` <li class=\"active\"><a href=\"${pno}\">${pno}</a></li>`;\r\n\r\n\r\n                if(pno+1<=maxPage)\r\n                    phtml+=`<li><a href=\"${pno+1}\">${pno+1}</a></li>`;\r\n\r\n                if(next>maxPage)\r\n                    phtml+=`<li class=\"disabled\">\r\n                        <a href=\"#\" aria-label=\"Next\">\r\n                            <span aria-hidden=\"true\">&raquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n                else\r\n                    phtml+=` <li>\r\n                        <a href=\"${pno+1}\" aria-label=\"Next\">\r\n                            <span aria-hidden=\"true\">&raquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n\r\n                pages.html(phtml);\r\n\r\n                //为分页条绑定事件\r\n\r\n                pages.off().on(\"click\",\"a\",function(e){\r\n                    e.preventDefault();\r\n                    if(!$(this).parent().hasClass(\"disabled\")){\r\n                        var pno = $(this).attr(\"href\");\r\n                        getlistbypno(pno);\r\n                    }\r\n\r\n                });\r\n\r\n\r\n\r\n\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    getlistbypno(1);\r\n\r\n\r\n});"]}