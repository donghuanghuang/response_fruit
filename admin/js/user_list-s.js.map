{"version":3,"sources":["user_list.js"],"names":[],"mappings":";;AAAA;;;AAGA,EAAE,YAAY;AACV,aAAS,YAAT,CAAsB,GAAtB,EAA0B;AACtB,YAAI,KAAI,EAAE,SAAF,CAAR;;AAEA,UAAE,IAAF,CAAO;AACH,iBAAI,kBADD;AAEH,kBAAK,KAFF;AAGH,kBAAK;AACD,qBAAI,GADH;AAED,0BAAS;AAFR,aAHF;AAOH,qBAAS,iBAAU,IAAV,EAAgB;AACrB,oBAAI,QAAQ,KAAK,IAAjB;AACA,oBAAI,OAAO,EAAX;AACA,oBAAI,MAAI,EAAR;AACA,oBAAI,QAAQ,KAAK,KAAjB;AACA,oBAAG,SAAO,CAAV,EAAY;AACR,0BAAI,WAAJ;AACH;;AAED,oBAAG,MAAM,MAAN,IAAc,CAAjB,EAAmB;AACf,4BAAM,0CAAN;AACH,iBAFD,MAEK;AACD,yBAAI,IAAI,CAAR,IAAa,KAAb,EAAmB;AACf,4BAAI,OAAO,MAAM,CAAN,CAAX;AACA,4BAAI,UAAU,OAAO,IAAI,IAAJ,CAAS,SAAS,KAAK,OAAd,CAAT,CAAP,CAAd;AACA,4BAAI,MAAM,KAAK,MAAL,IAAa,CAAb,GAAe,gDAA8C,GAA9C,GAAkD,cAAlD,GAAiE,KAAK,EAAtE,GAAyE,4BAAxF,GAAqH,iDAA+C,GAA/C,GAAmD,cAAnD,GAAkE,KAAK,EAAvE,GAA0E,4BAAzM;AACA,mFACkB,KAAK,EADvB,uDAEkB,KAAK,QAFvB,uDAGkB,KAAK,QAHvB,uDAIkB,KAAK,KAJvB,uDAKkB,KAAK,KALvB,uDAMkB,OANlB,wDAOkB,KAAK,MAAL,IAAa,CAAb,GAAe,MAAf,GAAsB,KAPxC,0JASuE,KAAK,EAT5E,4EAWkB,GAXlB;AAcH;;AAED,uBAAG,IAAH,CAAQ,IAAR;;AAEA;AACA;AACA,wBAAI,MAAM,SAAS,KAAK,GAAd,CAAV;AACA,wBAAI,QAAM,EAAV;AACA,wBAAI,QAAM,EAAE,aAAF,CAAV;AACA;AACA,wBAAI,OAAO,MAAI,CAAf;AACA,wBAAI,OAAO,MAAI,CAAf;AACA,wBAAI,UAAU,SAAS,KAAK,OAAd,CAAd;AACA,4BAAQ,GAAR,CAAY,GAAZ,EAAgB,OAAhB;AACA,wBAAG,QAAM,CAAT,EACI,mOADJ,KAOI,uDACW,MAAI,CADf;;AAMJ,wBAAG,MAAI,CAAJ,GAAM,CAAT,EACI,8BAAwB,MAAI,CAA5B,aAAkC,MAAI,CAAtC;;AAEJ,kEAAuC,GAAvC,WAA+C,GAA/C;;AAGA,wBAAG,MAAI,CAAJ,IAAO,OAAV,EACI,6BAAuB,MAAI,CAA3B,aAAiC,MAAI,CAArC;;AAEJ,wBAAG,OAAK,OAAR,EACI,+NADJ,KAOI,wDACW,MAAI,CADf;AAKJ;AACA,0BAAM,IAAN,CAAW,KAAX,EAAkB,GAAlB,GAAwB,EAAxB,CAA2B,OAA3B,EAAmC,GAAnC,EAAuC,UAAS,CAAT,EAAW;AAC9C,0BAAE,cAAF;AACA,4BAAG,CAAC,EAAE,IAAF,EAAQ,MAAR,GAAiB,QAAjB,CAA0B,UAA1B,CAAJ,EAA0C;AACtC,yCAAa,EAAE,IAAF,EAAQ,IAAR,CAAa,MAAb,CAAb;AACH;AAEJ,qBAND;;AASA,uBAAG,GAAH,GAAS,EAAT,CAAY,OAAZ,EAAoB,QAApB,EAA8B,YAAY;AACtC,4BAAI,OAAK,EAAE,WAAF,CAAT;AACA,4BAAI,MAAI,EAAE,IAAF,EAAQ,IAAR,CAAa,KAAb,CAAR;;AAEA,4BAAG,EAAE,IAAF,EAAQ,QAAR,CAAiB,QAAjB,CAAH,EAA8B;;AAE1B,gCAAI,yTAAJ;AAIA,iCAAK,KAAL,CAAW,MAAX,EAAmB,IAAnB,CAAwB,aAAxB,EAAuC,IAAvC,CAA4C,IAA5C;AACA,iCAAK,IAAL,CAAU,cAAV,EAA0B,IAA1B,CAA+B,MAA/B;;AAEA,8BAAE,SAAF,EAAa,GAAb,GAAmB,EAAnB,CAAsB,QAAtB,EAA+B,UAAS,CAAT,EAAW;AACtC,kCAAE,cAAF;AACA,oCAAI,OAAM,EAAE,eAAF,EAAmB,GAAnB,EAAV;;AAEA,oCAAG,KAAK,MAAL,GAAY,CAAf,EAAiB;AACb,0CAAM,YAAN;AACA;AACH;;AAED,kCAAE,IAAF,CAAO;AACH,yCAAI,qBADD;AAEH,0CAAK,MAFF;AAGH,0CAAK,EAAC,KAAI,GAAL,EAAS,MAAK,IAAd,EAHF;AAIH,6CAAS,iBAAU,IAAV,EAAgB;AACrB,4CAAG,KAAK,IAAL,IAAW,CAAd,EAAgB;AACZ,kDAAM,KAAK,GAAX;AACH,yCAFD,MAEK;AACD,kDAAM,MAAN;AACA,iDAAK,KAAL,CAAW,MAAX;AACA,yDAAa,GAAb;AACH;AACJ;AAZE,iCAAP;AAcA,uCAAO,KAAP;AACH,6BAxBD;AA0BH,yBAnCD,MAmCM,IAAG,EAAE,IAAF,EAAQ,QAAR,CAAiB,QAAjB,CAAH,EAA8B;AAChC,gCAAG,CAAC,EAAE,IAAF,EAAQ,QAAR,CAAiB,UAAjB,CAAJ,EAAiC;;AAE7B,oCAAI,OAAM,EAAE,IAAF,EAAQ,IAAR,CAAa,KAAb,CAAV;;AAEA,oCAAI,MAAK,EAAE,IAAF,EAAQ,IAAR,CAAa,KAAb,CAAT;;AAEA,kCAAE,IAAF,CAAO;AACH,yCAAI,uBADD;AAEH,0CAAK,MAFF;AAGH,0CAAK,EAAC,KAAI,IAAL,EAAU,QAAO,GAAjB,EAHF;AAIH,6CAAQ,iBAAS,IAAT,EAAc;AAClB,4CAAG,KAAK,IAAL,IAAW,SAAX,IAAwB,KAAK,IAAL,IAAW,CAAtC,EAAwC;AACpC,kDAAM,MAAN;AACH,yCAFD,MAEM,IAAG,KAAK,IAAL,IAAW,CAAd,EAAgB;AAClB,kDAAM,MAAN;AACA,yDAAa,GAAb;AACH;AACJ;;AAXE,iCAAP;AAeH;AACJ;AAGJ,qBAjED;AAqEH;AAEJ;AAtKE,SAAP;AAwKH;;AAED,MAAE,UAAF,EAAc,KAAd,CAAoB,YAAU;AAC1B,YAAI,OAAK,EAAE,WAAF,CAAT;;AAEA,YAAI,ghCAAJ;AAkBA,aAAK,KAAL,CAAW,MAAX,EAAmB,IAAnB,CAAwB,aAAxB,EAAuC,IAAvC,CAA4C,IAA5C;AACA,aAAK,IAAL,CAAU,cAAV,EAA0B,IAA1B,CAA+B,MAA/B;;AAEA,UAAE,SAAF,EAAa,GAAb,GAAmB,EAAnB,CAAsB,QAAtB,EAA+B,UAAS,CAAT,EAAW;AACtC,cAAE,cAAF;AACA,gBAAI,WAAW,EAAE,mBAAF,EAAuB,GAAvB,EAAf;AACA,gBAAI,WAAW,EAAE,mBAAF,EAAuB,GAAvB,EAAf;AACA,gBAAI,QAAQ,EAAE,gBAAF,EAAoB,GAApB,EAAZ;AACA,gBAAI,QAAQ,EAAE,gBAAF,EAAoB,GAApB,EAAZ;;AAEA,gBAAG,SAAS,MAAT,GAAgB,CAAhB,IAAqB,SAAS,MAAT,GAAgB,EAAxC,EAA2C;AACvC,sBAAM,eAAN;AACA;AACH;AACD,gBAAG,SAAS,MAAT,GAAgB,CAAhB,IAAqB,SAAS,MAAT,GAAgB,EAAxC,EAA2C;AACvC,sBAAM,YAAN;AACA;AACH;;AAED,gBAAG,CAAC,mCAAmC,IAAnC,CAAwC,KAAxC,CAAJ,EAAmD;AAC/C,sBAAM,WAAN;AACA;AACH;;AAED,cAAE,IAAF,CAAO;AACH,qBAAI,kBADD;AAEH,sBAAK,MAFF;AAGH,sBAAK;AACD,sCADC;AAED,sCAFC;AAGD,gCAHC;AAID;AAJC,iBAHF;AASH,yBAAQ,iBAAS,IAAT,EAAc;AAClB,wBAAG,KAAK,IAAL,IAAW,CAAd,EACI,MAAM,KAAK,GAAX,EADJ,KAEK,IAAG,KAAK,IAAL,IAAW,CAAd,EAAgB;AACjB,8BAAM,MAAN;AACA,6BAAK,KAAL,CAAW,MAAX;AACA,qCAAa,CAAb;AACH;AACJ;AAjBE,aAAP;AAmBA,mBAAO,KAAP;AACH,SAzCD;AA2CA,KAnEJ;;AAqEA,iBAAa,CAAb;AACA,aAAS,MAAT,CAAgB,IAAhB,EAAqB;;AAEjB,YAAI,IAAI,KAAK,WAAL,EAAR;AACA,YAAI,IAAI,KAAK,QAAL,KAAgB,CAAxB;;AAEA,YAAI,IAAI,KAAK,OAAL,EAAR;;AAGA,YAAI,IAAI,KAAK,QAAL,EAAR;;AAEA,YAAI,IAAI,KAAK,UAAL,EAAR;AACA,YAAE,EAAF,KAAO,IAAE,MAAI,CAAb;;AAEA,YAAI,IAAI,KAAK,UAAL,EAAR;AACA,YAAE,EAAF,KAAO,IAAE,MAAI,CAAb;;AAEA,eAAO,IAAE,GAAF,GAAM,CAAN,GAAQ,GAAR,GAAY,CAAZ,GAAc,IAAd,GAAmB,CAAnB,GAAqB,GAArB,GAAyB,CAAzB,GAA2B,GAA3B,GAA+B,CAAtC;AACH;AACJ,CAtQD","file":"user_list-s.js","sourcesContent":["/**\r\n * Created by web-01 on 2017/11/2.\r\n */\r\n$(function () {\r\n    function getUserByPno(pno){\r\n        var tb =$(\"#tblist\");\r\n\r\n        $.ajax({\r\n            url:\"data/getuser.php\",\r\n            type:\"get\",\r\n            data:{\r\n                pno:pno,\r\n                pageSize:8\r\n            },\r\n            success: function (data) {\r\n                var users = data.data;\r\n                var html = \"\";\r\n                var dis=\"\";\r\n                var power = data.power;\r\n                if(power!=0){\r\n                    dis=\" disabled\";\r\n                }\r\n\r\n                if(users.length==0){\r\n                    html+=\"<tr><td colspan='8'>没有更多用户了...</td></tr>\";\r\n                }else{\r\n                    for(var x in users){\r\n                        var user = users[x];\r\n                        var regtime = format(new Date(parseInt(user.regtime)));\r\n                        var btn = user.expire==0?\"<button class='btn btn-xs btn-danger btn-fj\"+dis+\"' data-uid='\"+user.id+\"' data-exp='1'>封禁</button>\":\"<button class='btn btn-success btn-xs btn-fj\"+dis+\"' data-uid='\"+user.id+\"' data-exp='0'>解禁</button>\";\r\n                        html+=`<tr>\r\n                                    <td>${user.id}</td>\r\n                                    <td>${user.username}</td>\r\n                                    <td>${user.password}</td>\r\n                                    <td>${user.email}</td>\r\n                                    <td>${user.phone}</td>\r\n                                    <td>${regtime}</td>\r\n                                    <td>${user.expire==0?\"状态正常\":\"已封禁\"}</td>\r\n                                    <td>\r\n                                        <button class=\"btn btn-info btn-xs btn-xg\" data-uid=\"${user.id}\">修改</button>\r\n\r\n                                        ${btn}\r\n                                    </td>\r\n                            </tr>`;\r\n                    }\r\n\r\n                    tb.html(html);\r\n\r\n                    //分页条生成\r\n                    //加载分页条\r\n                    var pno = parseInt(data.pno);\r\n                    var phtml=\"\";\r\n                    var pages=$(\"#pagination\");\r\n                    //var pno = parseInt(data.pno);\r\n                    var prev = pno-1;\r\n                    var next = pno+1;\r\n                    var maxPage = parseInt(data.maxPage);\r\n                    console.log(pno,maxPage);\r\n                    if(prev<=0)\r\n                        phtml+=`<li class=\"disabled\">\r\n                        <a href=\"#\" aria-label=\"Previous\">\r\n                            <span aria-hidden=\"true\">&laquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n                    else\r\n                        phtml+=`<li>\r\n                        <a href=\"${pno-1}\" aria-label=\"Previous\">\r\n                            <span aria-hidden=\"true\">&laquo;</span>\r\n                        </a>\r\n                        </li>`;\r\n\r\n                    if(pno-1>0)\r\n                        phtml+=` <li><a href=\"${pno-1}\">${pno-1}</a></li>`;\r\n\r\n                    phtml+=` <li class=\"active\"><a href=\"${pno}\">${pno}</a></li>`;\r\n\r\n\r\n                    if(pno+1<=maxPage)\r\n                        phtml+=`<li><a href=\"${pno+1}\">${pno+1}</a></li>`;\r\n\r\n                    if(next>maxPage)\r\n                        phtml+=`<li class=\"disabled\">\r\n                        <a href=\"#\" aria-label=\"Next\">\r\n                            <span aria-hidden=\"true\">&raquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n                    else\r\n                        phtml+=` <li>\r\n                        <a href=\"${pno+1}\" aria-label=\"Next\">\r\n                            <span aria-hidden=\"true\">&raquo;</span>\r\n                        </a>\r\n                    </li>`;\r\n                    //绑定事件\r\n                    pages.html(phtml).off().on(\"click\",\"a\",function(e){\r\n                        e.preventDefault();\r\n                        if(!$(this).parent().hasClass(\"disabled\")){\r\n                            getUserByPno($(this).attr(\"href\"));\r\n                        }\r\n\r\n                    });\r\n\r\n                    \r\n                    tb.off().on(\"click\",\"button\", function () {\r\n                        var amsg=$(\"#alertmsg\");\r\n                        var uid=$(this).data(\"uid\");\r\n\r\n                        if($(this).hasClass(\"btn-xg\")){\r\n\r\n                            var html =` <div class=\"form-group\">\r\n                                         <label for=\"npwd\">输入用户新密码:</label>\r\n                                         <input type=\"password\" class=\"form-control\"  required name=\"npwd\" \"/>\r\n                                    </div>`;\r\n                            amsg.modal(\"show\").find('.modal-body').html(html);\r\n                            amsg.find(\".modal-title\").html(\"修改用户\");\r\n\r\n                            $(\"#xgform\").off().on(\"submit\",function(e){\r\n                                e.preventDefault();\r\n                                var npwd =$(\"[name='npwd']\").val();\r\n\r\n                                if(npwd.length<6){\r\n                                    alert(\"密码必须大于等于6位\");\r\n                                    return;\r\n                                }\r\n\r\n                                $.ajax({\r\n                                    url:\"data/setpwdbyid.php\",\r\n                                    type:\"post\",\r\n                                    data:{uid:uid,npwd:npwd},\r\n                                    success: function (data) {\r\n                                        if(data.code<=0){\r\n                                            alert(data.msg);\r\n                                        }else{\r\n                                            alert(\"修改成功\");\r\n                                            amsg.modal(\"hide\");\r\n                                            getUserByPno(pno);\r\n                                        }\r\n                                    }\r\n                                });\r\n                                return false;\r\n                            });\r\n\r\n                        }else if($(this).hasClass('btn-fj')){\r\n                            if(!$(this).hasClass(\"disabled\")){\r\n\r\n                                var uid1 =$(this).data(\"uid\");\r\n\r\n                                var exp =$(this).data(\"exp\");\r\n\r\n                                $.ajax({\r\n                                    url:\"data/setuserstate.php\",\r\n                                    type:\"post\",\r\n                                    data:{uid:uid1,expire:exp},\r\n                                    success:function(data){\r\n                                        if(data.code==undefined || data.code<=0){\r\n                                            alert(\"操作失败\");\r\n                                        }else if(data.code==1){\r\n                                            alert(\"操作成功\");\r\n                                            getUserByPno(pno);\r\n                                        }\r\n                                    }\r\n\r\n                                });\r\n\r\n                            }\r\n                        }\r\n\r\n\r\n                    })\r\n\r\n\r\n\r\n                }\r\n\r\n            }\r\n        })\r\n    }\r\n\r\n    $(\"#adduser\").click(function(){\r\n        var amsg=$(\"#alertmsg\");\r\n\r\n        var html =` <div class=\"form-group\">\r\n                      <label for=\"username\">输入用户名:</label>\r\n                      <input type=\"text\" class=\"form-control\" required name=\"username\" \"/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"password\">输入密码:</label>\r\n                      <input type=\"password\"  class=\"form-control\"  required name=\"password\" \"/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"email\">输入邮箱:</label>\r\n                      <input type=\"email\"  class=\"form-control\" required name=\"email\" \"/>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                      <label for=\"phone\">输入手机:</label>\r\n                      <input type=\"text\" class=\"form-control\"   required name=\"phone\" \"/>\r\n                    </div>\r\n\r\n                    `;\r\n        amsg.modal(\"show\").find('.modal-body').html(html);\r\n        amsg.find(\".modal-title\").html(\"添加用户\");\r\n\r\n        $(\"#xgform\").off().on(\"submit\",function(e){\r\n            e.preventDefault();\r\n            var username = $('[name=\"username\"]').val();\r\n            var password = $('[name=\"password\"]').val();\r\n            var email = $('[name=\"email\"]').val();\r\n            var phone = $('[name=\"phone\"]').val();\r\n\r\n            if(username.length<6 || username.length>12){\r\n                alert(\"用户名长度在6-12位之间\");\r\n                return;\r\n            }\r\n            if(password.length<6 || password.length>12){\r\n                alert(\"密码在6-12位之间\");\r\n                return;\r\n            }\r\n\r\n            if(!/^((\\+86|0086)\\s+)?1[34578]\\d{9}$/.test(phone)){\r\n                alert(\"手机号码格式不正确\");\r\n                return;\r\n            }\r\n\r\n            $.ajax({\r\n                url:\"data/adduser.php\",\r\n                type:\"post\",\r\n                data:{\r\n                    username,\r\n                    password,\r\n                    email,\r\n                    phone\r\n                },\r\n                success:function(data){\r\n                    if(data.code<=0)\r\n                        alert(data.msg);\r\n                    else if(data.code==1){\r\n                        alert(\"添加成功\");\r\n                        amsg.modal(\"hide\");\r\n                        getUserByPno(1);\r\n                    }\r\n                }\r\n            });\r\n            return false;\r\n        });\r\n\r\n       });\r\n\r\n    getUserByPno(1);\r\n    function format(date){\r\n\r\n        var y = date.getFullYear();\r\n        var M = date.getMonth()+1;\r\n\r\n        var d = date.getDate();\r\n\r\n\r\n        var h = date.getHours();\r\n\r\n        var m = date.getMinutes();\r\n        m<10&&(m=\"0\"+m);\r\n\r\n        var s = date.getSeconds();\r\n        s<10&&(s=\"0\"+s);\r\n\r\n        return y+\"年\"+M+\"月\"+d+\"日 \"+h+\":\"+m+\":\"+s;\r\n    }\r\n});"]}