{"version":3,"sources":["base.js"],"names":[],"mappings":";;AAAA;;;;;;;;AAQI;AACA,EAAE,IAAF,CAAO;AACH,SAAI,mBADD;AAEH,UAAK;AAFF,CAAP;;AAKA;AACA,EAAE,IAAF,CAAO;AACH,SAAI,aADD;AAEH,UAAK,KAFF;AAGH,aAAQ,iBAAS,IAAT,EAAc;AAClB,UAAE,aAAF,EAAiB,IAAjB,CAAsB,IAAtB;AACA,UAAE,IAAF,CAAO;AACC;AACA,iBAAI,kBAFL;AAGC,kBAAK,KAHN;AAIC,qBAAQ,iBAAS,IAAT,EAAc;;AAElB,oBAAG,KAAK,EAAL,IAAS,CAAZ,EAAc;AACV;;AAEA,wBAAI,mEAA+C,KAAK,KAApD,mRAAJ;AAGA,sBAAE,eAAF,EAAmB,MAAnB,CAA0B,IAA1B;AACA;;AAEA;;AAOA,sBAAE,mBAAF,EAAuB,IAAvB,CAA4B,IAA5B;AACA,sBAAE,aAAF,EAAiB,IAAjB,CAAsB,IAAtB;AAEH,iBAnBD,MAmBK;AACD;AACA,wBAAI,mLAAJ;AAEA,sBAAE,eAAF,EAAmB,MAAnB,CAA0B,IAA1B;;AAEA;;AAOA,sBAAE,mBAAF,EAAuB,IAAvB,CAA4B,IAA5B;AACA,sBAAE,aAAF,EAAiB,IAAjB,CAAsB,IAAtB;AACH;AACD;AACA,kBAAE,SAAF,EAAa,KAAb,CAAmB,aAAG;AAClB,sBAAE,cAAF;AACA,sBAAE,IAAF,CAAO;AACH,6BAAI,iBADD;AAEH,8BAAK,KAFF;AAGH,iCAAQ,mBAAU;AACd,qCAAS,MAAT;AACH;AALE,qBAAP;AAQH,iBAVD;;AAaA,kBAAE,WAAF,EAAe,EAAf,CAAkB,OAAlB,EAA0B,YAAU;AAChC,wBAAG,CAAC,EAAE,IAAF,EAAQ,QAAR,CAAiB,MAAjB,CAAJ,EACI;AACJ;AACH,iBAJD;;AAMA;AAEH;AA/DF,SAAP;AAmEH;AAxEE,CAAP;;AA4EA;AACA,EAAE,IAAF,CAAO;AACH,SAAI,aADD;AAEH,UAAK,KAFF;AAGT,aAAQ,iBAAS,IAAT,EAAc;AACZ;AACA,YAAI,k3BAAJ;;AAmBA,UAAE,aAAF,EAAiB,IAAjB,CAAsB,IAAtB,EAA4B,KAA5B,CAAkC,IAAlC;AAET;AA1BQ,CAAP;;AA6BA;AACA,SAAS,SAAT,GAAoB;AAChB,MAAE,IAAF,CAAO;AACH,aAAI,kBADD;AAEH,cAAK,KAFF;AAGH,iBAAQ,iBAAS,IAAT,EAAc;AAClB,gBAAI,OAAK,EAAT;AACA,gBAAI,QAAM,CAAV;;AAEA,gBAAG,KAAK,EAAL,IAAS,CAAT,IAAc,KAAK,MAAL,IAAa,CAA9B,EAAgC;AAC5B,khBAQiD,MAAM,OAAN,CAAc,CAAd,CARjD;AAmBH,aApBD,MAoBK;AACD,qBAAI,IAAI,CAAR,IAAa,IAAb,EAAkB;AACd,wBAAI,IAAG,KAAK,CAAL,CAAP;AACA,6BAAO,WAAW,EAAE,KAAb,IAAoB,EAAE,MAA7B;AACA,uIACoD,EAAE,EADtD,yJAGwC,EAAE,KAH1C,gIAKuC,EAAE,KALzC,gFAMuC,EAAE,MANzC,iFAOuC,EAAE,GAPzC;AAWH;;AAED,iTAIiD,MAAM,OAAN,CAAc,CAAd,CAJjD;AAgBH;AACD;AACA,cAAE,QAAF,EAAY,IAAZ,CAAiB,IAAjB,EAAuB,EAAvB,CAA0B,OAA1B,EAAkC,mBAAlC,EAAsD,UAAS,CAAT,EAAW;AAC7D,kBAAE,cAAF;AACA,kBAAE,IAAF,CAAO;AACH,yBAAI,kBADD;AAEH,0BAAK,EAAC,KAAI,EAAE,IAAF,EAAQ,IAAR,CAAa,KAAb,CAAL,EAFF;AAGH,0BAAK,MAHF;AAIH,6BAAQ,iBAAS,IAAT,EAAc;AAClB,4BAAG,KAAK,EAAL,IAAS,CAAZ,EACI,MAAM,MAAN,EADJ,KAEK,IAAG,KAAK,EAAL,IAAS,CAAZ,EAAc;AACf;AACA;AACH;AACJ;AAXE,iBAAP;AAcH,aAhBD;AAiBH;AA/EE,KAAP;AAiFH;;AAED;;AAEA,EAAE,iBAAF,EAAqB,EAArB,CAAwB,oBAAxB,EAA6C,YAAU;AACnD,QAAI,KAAI,EAAE,IAAF,EAAQ,GAAR,EAAR;AACA,QAAG,MAAI,EAAP,EAAU;AACN,UAAE,cAAF,EAAkB,QAAlB,CAA2B,MAA3B,EAAmC,IAAnC,CAAwC,EAAxC;AACH,KAFD,MAEK;AACD,UAAE,IAAF,CAAO;AACH,iBAAI,iBADD;AAEH,kBAAK,EAAC,IAAG,EAAJ,EAFF;AAGH,kBAAK,KAHF;AAIH,qBAAQ,iBAAS,IAAT,EAAe;AACnB,oBAAI,KAAK,MAAL,IAAe,CAAf,IAAoB,QAAQ,EAAhC,EACI,OADJ,KAEK;AACD,wBAAI,OAAO,EAAX;AACA,yBAAK,IAAI,CAAT,IAAc,IAAd,EAAoB;AAChB,4BAAI,IAAI,KAAK,CAAL,CAAR;AACA,oDAAyB,EAAE,GAA3B,WAAmC,EAAE,KAArC,4BAA+D,EAAE,KAAjE;AACH;AACD,sBAAE,cAAF,EAAkB,WAAlB,CAA8B,MAA9B,EAAsC,IAAtC,CAA2C,IAA3C;AACH;AACJ;;AAfE,SAAP;AAoBH;AAEJ,CA3BD;;AA6BA;AACA,EAAE,cAAF,EAAkB,EAAlB,CAAqB,OAArB,EAA6B,IAA7B,EAAkC,YAAU;AACxC,aAAS,IAAT,GAAc,6BAA2B,EAAE,IAAF,EAAQ,IAAR,CAAa,KAAb,CAAzC;AACH,CAFD;;AAIA;AACA,SAAS,OAAT,GAAkB;AACd,MAAE,IAAF,CAAO;AACH,aAAI,kBADD;AAEH,cAAK,KAFF;AAGH,iBAAQ,iBAAS,IAAT,EAAc;AAClB,gBAAG,KAAK,EAAL,IAAS,CAAZ,EACI,EAAE,sBAAF,EAA0B,IAA1B,CAA+B,KAAK,MAApC,EADJ,KAEM,EAAE,sBAAF,EAA0B,IAA1B,CAA+B,CAA/B;AACT;AAPE,KAAP;AASH;;AAKL;;AAEA,SAAS,QAAT,CAAkB,KAAlB,EAAwB,GAAxB,EAA4B,SAA5B,EAAsC,IAAtC,EAA2C,IAA3C,EAAgD,QAAhD,EAAyD;AACrD,QAAI,SAAQ,EAAE,WAAF,CAAZ;AACA,WAAO,IAAP,CAAY,cAAZ,EAA4B,IAA5B,CAAiC,KAAjC;AACA,WAAO,IAAP,CAAY,aAAZ,EAA2B,IAA3B,CAAgC,GAAhC;AACA,WAAO,IAAP,CAAY,4BAAZ,EAA0C,IAA1C,CAA+C,IAA/C;;AAEA,QAAG,CAAC,SAAJ,EAAc;AACV,eAAO,IAAP,CAAY,4BAAZ,EAA0C,QAA1C,CAAmD,MAAnD;AACA,eAAO,IAAP,CAAY,4BAAZ,EAA0C,IAA1C,CAA+C,IAA/C,EAAqD,EAArD,CAAwD,OAAxD,EAAgE,QAAhE;AACH,KAHD,MAGK;AACD,eAAO,IAAP,CAAY,4BAAZ,EAA0C,IAA1C,CAA+C,IAA/C,EAAqD,EAArD,CAAwD,OAAxD,EAAgE,QAAhE;AACH;;AAGD,WAAO,KAAP,CAAa,MAAb;AACH","file":"base-s.js","sourcesContent":["/**\n * 此文件存放公共调用的js代码\n *包括\n *  加载页头 页尾 顶部购物车\n *  判断是否登录\n *  搜索帮助 顶部购物车数量更新\n *  弹出模态框 等公共代码\n */\n    /*记录IP访问*/\n    $.ajax({\n        url:\"data/vhistory.php\",\n        type:\"get\"\n    });\n\n    /*加载页头*/\n    $.ajax({\n        url:\"header.html\",\n        type:\"get\",\n        success:function(data){\n            $(\"body>header\").html(data);\n            $.ajax({\n                    //判断是否登陆\n                    url:\"data/isLogin.php\",\n                    type:\"get\",\n                    success:function(data){\n\n                        if(data.ok==1){\n                            //如果已经登录\n\n                            var html =`<li class=\"hidden-xs\"><span>用户名&nbsp;:${data.uname}&nbsp;&nbsp;</span><a class=\"logout\" href=\"#\">注销</a></li>\n                   <li class=\"hidden-xs\"><a href=\"list.html\">个人中心</a></li>\n                    <li class=\"hidden-xs\"><a href=\"checkout.html\">收银台</a></li>`;\n                            $(\"#user_info>li\").before(html);\n                            /*加载导航条*/\n\n                            html=`<li><a href=\"index.html\" >主页</a></li>\n                    <li><a href=\"list.html\" >个人中心</a></li>\n                    <li><a href=\"cart.html\">购物车</a></li>\n                    <li><a class=\"logout\" href=\"#\">注销</a></li>\n                    <li><a href=\"about.html\">关于</a></li>`;\n\n\n                            $(\"body>nav .nav_bar\").html(html);\n                            $(\"body ul.ulr\").html(html);\n\n                        }else{\n                            //未登录\n                            var html =`<li class=\"hidden-xs\"><a href=\"login.html\">登录</a></li>\n                             <li class=\"hidden-xs\"><a href=\"register.html\">注册</a></li>`;\n                            $(\"#user_info>li\").before(html);\n\n                            html=`<li><a href=\"index.html\" >主页</a></li>\n                    <li><a href=\"login.html\" >登录</a></li>\n                    <li><a href=\"register.html\">注册</a></li>\n                    <li><a href=\"about.html\">联系我们</a></li>\n                    <li><a href=\"about.html\">关于</a></li>\n                    `;\n\n                            $(\"body>nav .nav_bar\").html(html);\n                            $(\"body ul.ulr\").html(html);\n                        }\n                        //注销\n                        $(\".logout\").click(e=>{\n                            e.preventDefault();\n                            $.ajax({\n                                url:\"data/logout.php\",\n                                type:\"get\",\n                                success:function(){\n                                    location.reload()\n                                }\n                            });\n\n                        });\n\n\n                        $(\".top_cart\").on(\"click\",function(){\n                            if(!$(this).hasClass('open'))\n                                getopcart();\n                            upcount();\n                        });\n\n                        upcount();\n\n                    }\n                }\n            );\n\n        }\n    });\n\n\n    /*加载 页尾 */\n    $.ajax({\n        url:\"footer.html\",\n        type:\"get\",\n\t\tsuccess:function(data){\n            //将模态框加入到footer 元素后面\n            var html=`\n    <div class=\"modal fade\" id=\"alertmsg\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myalert\">\n        <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                <h4 class=\"modal-title\" id=\"myalert\">标题</h4>\n            </div>\n            <div class=\"modal-body\">\n                ...\n            </div>\n            <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-default\" data-dismiss=\"modal\">关闭</button>\n                <button type=\"button\" class=\"btn btn-primary\">保存</button>\n            </div>\n        </div>\n    </div>\n</div>`;\n\n            $(\"body>footer\").html(data).after(html);\n\t\t\t\n\t\t}\n    });\n\n    /*加载顶部购物车*/\n    function getopcart(){\n        $.ajax({\n            url:\"data/getcart.php\",\n            type:\"get\",\n            success:function(data){\n                var html=\"\";\n                var total=0;\n\n                if(data.ok==0 || data.length==0){\n                    html+=`\n                        <div class=\"container-fluid\">\n                             <div class=\"row mt-20\">\n                                <div class=\"col-xs-12\">您的购物车没有任何商品</div>\n                            </div>\n\n                            <div class=\"row mt-20\">\n                                <div class=\"col-xs-6 totaltitle\">总价:</div>\n                                <div class=\"col-xs-6 totalprice\"> ￥${total.toFixed(2)}</div>\n                            </div>\n                        </div>\n\n                        <div class=\"container-fluid\">\n                            <div class=\"row mt-10\">\n                                <a href=\"checkout.html\" class=\"btn btn-danger\">去结算</a>\n                                <a href=\"cart.html\" class=\"btn btn-success\">购物车</a>\n                            </div>\n                        </div>`;\n\n                }else{\n                    for(var x in data){\n                        var p =data[x];\n                        total+=parseFloat(p.price)*p.fcount;\n                        html+=`<div class=\"media\">\n                             <div class=\"media-left\"><img width=\"50\" src=\"${p.lg}\" alt=\"\"/></div>\n                                <div class=\"media-body\">\n                                    <h4 class=\"media-heading\">${p.title}</h4>\n                                      <div>\n                                        <span class=\"price\">￥${p.price}</span>\n                                       <span class=\"count\">X ${p.fcount}</span>\n                                       <a href=\"#\" data-fid=\"${p.fid}\" class=\"glyphicon glyphicon-remove fr\"></a>\n                             </div>\n                       </div>\n              </div>`;\n                    }\n\n                    html+=`\n                        <div class=\"container-fluid\">\n                            <div class=\"row mt-20\">\n                                <div class=\"col-xs-6 totaltitle\">总价:</div>\n                                <div class=\"col-xs-6 totalprice\"> ￥${total.toFixed(2)}</div>\n                            </div>\n                        </div>\n\n                        <div class=\"container-fluid\">\n                            <div class=\"row mt-10\">\n                                <a href=\"checkout.html\" class=\"btn btn-danger\">去结算</a>\n                                <a href=\"cart.html\" class=\"btn btn-success\">购物车</a>\n                            </div>\n                        </div>`;\n\n\n                }\n                //购物车删除事件\n                $(\".ocart\").html(html).on(\"click\",\".glyphicon-remove\",function(e){\n                    e.preventDefault();\n                    $.ajax({\n                        url:\"data/delcart.php\",\n                        data:{fid:$(this).data(\"fid\")},\n                        type:\"post\",\n                        success:function(data){\n                            if(data.ok==0)\n                                alert(\"删除失败\");\n                            else if(data.ok==1){\n                                getopcart();\n                                upcount();\n                            }\n                        }\n                    });\n\n                });\n            }\n        });\n    }\n\n    /*为搜索框绑定事件  搜索帮助*/\n\n    $(\".seachtxt>input\").on(\"change focus keyup\",function(){\n        var kw =$(this).val();\n        if(kw==\"\"){\n            $(\".seachtxt>ul\").addClass('hide').html(\"\");\n        }else{\n            $.ajax({\n                url:\"data/search.php\",\n                data:{kw:kw},\n                type:\"get\",\n                success:function(data) {\n                    if (data.length == 0 || data == [])\n                        return;\n                    else {\n                        var html = \"\";\n                        for (var x in data) {\n                            var d = data[x];\n                            html += `<li data-fid=\"${d.fid}\">${d.title} <span class=\"fr\">${d.price} </span></li>`;\n                        }\n                        $(\".seachtxt>ul\").removeClass('hide').html(html);\n                    }\n                }\n\n            });\n\n\n        }\n\n    });\n\n    /*为搜索帮助结果的Li绑定事件*/\n    $(\".seachtxt>ul\").on(\"click\",'li',function(){\n        location.href=\"product_detail.html?fid=\"+$(this).data(\"fid\");\n    });\n\n    /*顶部购物车数量加载*/\n    function upcount(){\n        $.ajax({\n            url:\"data/getcart.php\",\n            type:\"get\",\n            success:function(data){\n                if(data.ok!=0)\n                    $(\".top_cart>span:eq(0)\").html(data.length);\n                else  $(\".top_cart>span:eq(0)\").html(0);\n            }\n        });\n    }\n\n\n\n\n/*弹出自定义模态框*/\n\nfunction alertMsg(title,msg,isConfirm,btn1,btn2,callback){\n    var dialog= $(\"#alertmsg\");\n    dialog.find(\".modal-title\").html(title);\n    dialog.find(\".modal-body\").html(msg);\n    dialog.find(\".modal-footer>button:eq(0)\").html(btn1);\n\n    if(!isConfirm){\n        dialog.find(\".modal-footer>button:eq(1)\").addClass(\"hide\");\n        dialog.find(\".modal-footer>button:eq(0)\").html(btn2).on(\"click\",callback);\n    }else{\n        dialog.find(\".modal-footer>button:eq(1)\").html(btn2).on(\"click\",callback);\n    }\n\n\n    dialog.modal(\"show\");\n}\n\n"]}